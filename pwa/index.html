<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Text Neck Guard</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/style.css">

    <!-- MediaPipe dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"
        crossorigin="anonymous"></script>
</head>

<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <h1 class="logo">Text Neck Guard</h1>
            <div class="header-controls">
                <div class="status-indicator" id="status-indicator">
                    <span class="status-dot"></span>
                    <span id="status-text">Inactive</span>
                </div>
                <button id="settings-btn" class="btn-icon">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Main Content (Reading Area) -->
        <main id="reading-container" class="reading-container">
            <div class="content-wrapper">
                <p class="intro">
                    Enable the guard to protect your neck while reading.
                    If you look down for too long, the text will blur and your phone will vibrate.
                </p>

                <article id="sample-article" class="article-content">
                    <h2>The Silent Epidemic of "Text Neck"</h2>
                    <p>In an age where digital connection is paramount, a silent physical toll is being exacted on the
                        human body. "Text Neck," a term coined to describe the repeated stress injury and pain in the
                        neck resulting from excessive watching or texting on handheld devices for long periods of time,
                        is becoming increasingly prevalent.</p>
                    <p>The human head weighs about 10 to 12 pounds. However, as the neck bends forward and down, the
                        weight on the cervical spine begins to increase. At a 15-degree angle, this weight is about 27
                        pounds, at 30 degrees it‚Äôs 40 pounds, at 45 degrees it‚Äôs 49 pounds, and at 60 degrees it‚Äôs 60
                        pounds.</p>
                    <p>Imagine carrying an 8-year-old around your neck for several hours a day. Commuters, students, and
                        office workers are particularly at risk. The long-term effects can include early onset
                        arthritis, spinal degeneration, muscle strain, and even pinched nerves.</p>
                    <h3>How This App Helps</h3>
                    <p>By using the front-facing camera, this application uses advanced computer vision to detect the
                        angle of your neck. It establishes a feedback loop.</p>
                    <p>When you maintain a healthy posture, the text remains clear. As you slouch or bend your neck
                        excessively (>45 degrees) for a sustained period, the app gently nudges you back to better
                        posture by blurring the text you are trying to read and providing haptic feedback.</p>
                    <p>This "operant conditioning" helps build muscle memory for better posture without the need for
                        constant conscious effort.</p>
                    <p>Review the settings to adjust sensitivity or read more content.</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut
                        labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                        laboris nisi ut aliquip ex ea commodo consequat.</p>
                    <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
                        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
                        mollit anim id est laborum.</p>
                </article>
            </div>
        </main>

        <!-- Controls / Floating Action Button -->
        <div class="controls">
            <button id="toggle-guard-btn" class="btn-fab">
                üõ°Ô∏è Activate
            </button>
            <button id="pip-btn" class="btn-fab secondary hidden" title="Pop Out Widget">
                ‚ÜóÔ∏è
            </button>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button id="close-settings" class="btn-text">‚úï</button>
                </div>

                <div class="setting-group">
                    <h3>Calibration</h3>
                    <p class="setting-desc">Sit up straight with phone at eye level.</p>
                    <button id="calibrate-btn" class="btn-secondary">Set Healthy Posture (Zero)</button>
                    <p id="calibration-status" class="status-small">Default</p>
                </div>

                <div class="setting-group">
                    <h3>Time Limit</h3>
                    <div class="range-wrap">
                        <label for="timer-slider">Delay</label>
                        <input type="range" id="timer-slider" min="2" max="120" step="1" value="5">
                        <span id="timer-val">5s</span>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Sensitivity</h3>
                    <div class="range-wrap">
                        <label for="sensitivity-slider">Tolerance</label>
                        <input type="range" id="sensitivity-slider" min="0.5" max="1.5" step="0.05" value="0.85">
                        <span id="sensitivity-val">0.85</span>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Content</h3>
                    <textarea id="custom-text-input" placeholder="Paste your article or book text here..."
                        rows="4"></textarea>
                    <button id="load-text-btn" class="btn-primary small">Load Text</button>
                </div>

                <div class="setting-group">
                    <h3>Debug</h3>
                    <button id="toggle-debug-btn" class="btn-text small">Toggle Camera View</button>
                </div>
            </div>
        </div>

        <!-- Hidden Camera Feed for Debug/Setup -->
        <div id="camera-preview" class="camera-preview hidden">
            <video id="input-video" playsinline muted></video>
            <canvas id="output-canvas"></canvas>
            <div class="close-preview" id="close-preview">‚úï</div>
            <div class="debug-info" id="debug-info">Pitch: --</div>
        </div>
    </div>

    <!-- Logic -->
    <script src="js/app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>

</html>